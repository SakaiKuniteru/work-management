<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-4 col-lg-3 sidebar">
            <div class="d-flex align-items-center mb-4">
                <img src="/img/logo.png" alt="Logo" style="height: 32px; margin-right: 10px;">
                <h5 class="mb-0 fw-bold">Trung tâm tài khoản</h5>
            </div>

            <a href="/setting" class="nav-link mb-2" data-page="personal" data-bs-toggle="tooltip" data-bs-placement="bottom">
                <i class="fa fa-user"></i> Trang cá nhân
            </a>

            <p class="small text-muted mb-4">
                Quản lý phần cài đặt tài khoản và trải nghiệm kết nối trên các công nghệ của bạn.
            </p>

            <nav class="nav flex-column">
                <a href="/password-security" class="nav-link" data-bs-toggle="tooltip" data-bs-placement="bottom">
                    <i class="fa fa-shield-alt"></i> 
                    Mật khẩu và bảo mật
                </a>

                <a href="/information" class="nav-link" data-bs-toggle="tooltip" data-bs-placement="bottom">
                    <i class="fa fa-id-card"></i> 
                    Thông tin cá nhân
                </a>

                <a href="/logout" class="nav-link" data-bs-toggle="tooltip" data-bs-placement="bottom">
                    <i class="fa fa-sign-out-alt"></i> 
                    Đăng xuất
                </a>
            </nav>
        </div>

<!-- Content -->
<div class="col-md-8 col-lg-9 p-4">
    <h4 class="fw-bold mb-5">Mật khẩu và Bảo mật</h4>
    <h6 class="fw-bold mb-1">Đăng nhập và khôi phục</h6>
    <p class="text-muted mb-0 small">
        Quản lý mật khẩu, tùy chọn đăng nhập và phương thức khôi phục.
    </p>

    <div class="card mt-3" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div class="fw-bold">Đổi mật khẩu</div>
            <i class="fa fa-chevron-right text-muted"></i>
        </div>
    </div>
</div>


<!-- Modal 1: Đổi mật khẩu -->
<div class="modal fade" id="changePasswordModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" style="max-width: 500px;">
    <div class="modal-content">
      <div class="modal-body p-4">
        <h5 class="fw-bold mb-2">Đổi mật khẩu</h5>
        <p class="text-muted small">
          Mật khẩu của bạn phải có tối thiểu 8 ký tự, đồng thời bao gồm cả chữ số, chữ cái, chữ hoa và ký tự đặc biệt (!$@%).
        </p>

        <div class="mt-4">
          <div class="mb-3">
            <label class="form-label">Mật khẩu hiện tại</label>
            <input type="password" class="form-control" placeholder="Nhập mật khẩu hiện tại">
          </div>

          <div class="mb-3">
            <label class="form-label">Mật khẩu mới</label>
            <input type="password" class="form-control" placeholder="Nhập mật khẩu mới">
          </div>

          <div class="mb-4">
            <label class="form-label">Nhập lại mật khẩu mới</label>
            <input type="password" class="form-control" placeholder="Nhập lại mật khẩu mới">
          </div>

          <div class="text-center">
            <button class="btn btn-primary w-100" onclick="openOtpModal()">
              Đổi mật khẩu
            </button>
          </div>
        </div>

        <button type="button" class="btn-close position-absolute top-0 end-0 m-3" data-bs-dismiss="modal"></button>
      </div>
    </div>
  </div>
</div>

<!-- Modal 2: Xác thực OTP -->
<div class="modal fade" id="otpModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" style="max-width: 500px;">
    <div class="modal-content">
      <div class="modal-header border-0">
        <button type="button" class="btn btn-link text-dark p-0 me-2" onclick="backToChangePasswordModal()">
          <i class="fa fa-arrow-left fa-lg"></i>
        </button>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body p-4 text-center">
        <h5 class="fw-bold mb-3">Xác thực OTP</h5>
        <p class="text-muted small">
          Nhập mã OTP đã được gửi đến số điện thoại hoặc email của bạn.
        </p>

        <input type="text" class="form-control mb-4 mt-3" placeholder="Nhập mã OTP">

        <button class="btn btn-primary w-100">
          Xác nhận
        </button>
      </div>
    </div>
  </div>
</div>

    </div>
</div>

<script>
    document.querySelectorAll('.nav-link').forEach(link => {
        const href = link.getAttribute('href');
        if (href && href !== '#') {
            const linkPath = new URL(href, window.location.origin).pathname;
            if (window.location.pathname === linkPath) {
                link.classList.add('active', 'text-primary');
            }
        }
    });

    function openOtpModal() {
  var changeModal = bootstrap.Modal.getInstance(document.getElementById('changePasswordModal'));
  if (changeModal) changeModal.hide();

  setTimeout(() => {
    var otpModal = new bootstrap.Modal(document.getElementById('otpModal'));
    otpModal.show();
  }, 300);
}

function backToChangePasswordModal() {
  var otpModal = bootstrap.Modal.getInstance(document.getElementById('otpModal'));
  if (otpModal) otpModal.hide();

  setTimeout(() => {
    var changeModal = new bootstrap.Modal(document.getElementById('changePasswordModal'));
    changeModal.show();
  }, 300);
}

// Fix lỗi treo backdrop nếu đóng modal
document.querySelectorAll('.modal').forEach(modal => {
  modal.addEventListener('hidden.bs.modal', () => {
    document.body.classList.remove('modal-open');
    document.querySelectorAll('.modal-backdrop').forEach(e => e.remove());
  });
});
</script>